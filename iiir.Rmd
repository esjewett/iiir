---
title: "Inequality in Inequality Research"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Examples

### Smaller population is invisible unless we already know about it

```{r, echo=FALSE}
library(MASS)
library(ggplot2)
set.seed(246534)
#main <- data.frame(mainX,mainY)
sig <- diag(2)
sig[2,1] = 0.5
sig[1,2] = 0.5
main <- data.frame(mvrnorm(1000,rep(0,2),sig))
main$Group <- "Main"

sig[2,1] = -0.5
sig[1,2] = -0.5
sub <- data.frame(mvrnorm(100,rep(-1,2),sig))
sub$Group <- "Sub"

combined <- rbind(main,sub)
combined$Group = factor(combined$Group)
```

```{r, fig.cap="Population sample with linear fit", echo=FALSE}
ggplot(combined, aes(x=X1, y=X2)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE)
```

```{r, fig.cap="Residual plots look reasonable", echo=FALSE}
par(mfrow = c(2,2))
plot(lm(X1 ~ X2, data=combined))
```

If we didn't suspect the existence of sub-populations, we might have stopped here. In fact, we know that this data was generated by combining 2 sub-groups into a single population.

```{r, fig.cap="In reality, this 'population' is composed of 2 distinct sub-groups with opposite covariance between the predictor and response variables. One population is 10% of the size of the other.", echo=FALSE}
ggplot(combined, aes(x=X1, y=X2)) +
  geom_point(aes(color=Group)) +
  geom_smooth(method = "lm", se = TRUE)
```

```{r, fig.cap="The linear fit for the larger sub-group is almost identical to the linear fit for the full population.", echo=FALSE}
ggplot(combined, aes(x=X1, y=X2, color=Group)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE)
```

Notably, inference based on the first model without knowledge of the sub-groups might result in recommendations to increase X1 in order to improve our outcome X2. Such an increase would in fact be detrimental to the smaller sub-group, but overall would result in an improvement. Without knowing to look for sub-group effects across this particular type of sub-group, the researcher could end up making a recommendation that disadvantages the sub-population.

Some types of sub-populations: Ethnic group, socio-economic status, geographical, people who eat or don't eat a type of food, users of specific medications, users of specific recreational drugs, people with specific medical conditions, people with a particular genetic mutation.

At root, this problem is due to an incorrect conceptual model underlying the analysis. But the point here is that the effect of the flawed model is effectively invisible to the researcher using diagnostic techniques currently available. The problem only becomse visible once we update the model to include the relevant sub-group, however there would be no reason to include the sub-group in data collection or modeling unless we have evidence leading us to believe that this sub-group is relevant. Evidence which can't exist in a quantitative form until we have included the sub-group.

### Interactions can increase inequality

Can also be thought of as leverage.